# Fast Credentials & API Reference

## ‚úÖ Database Seeded Successfully!

**Summary:**
- 11 Users (1 admin, 10 donors)
- 15 Donor Registrations (10 approved, 3 pending, 2 rejected)
- 10 Donor Profiles
- 5 Messages
- 5 Alerts
- 8 Notifications

**Admin Login:**
- Contact: `09171234567`
- Email: `admin@blooddonor.ph`

---

## üóÑÔ∏è Database Access

### Adminer Web Interface (Running)
**URL:** http://localhost:8082

**Login Details:**
- System: `PostgreSQL`
- Server: `postgres` (or `localhost` if connecting from host)
- Username: `blood_donor_user`
- Password: `blood_donor_pass`
- Database: `blood_donor_db`

### pgAdmin (Optional - Not Running)
**URL:** http://localhost:5050 (if installed separately)

**Connection Details:**
- Host: `localhost`
- Port: `5432`
- Database: `blood_donor_db`
- Username: `blood_donor_user`
- Password: `blood_donor_pass`

### Direct psql Access
```bash
psql -U blood_donor_user -d blood_donor_db -h localhost -p 5432
# Password: blood_donor_pass
```

### Docker psql Access
```bash
docker exec -it blood_donor_db psql -U blood_donor_user -d blood_donor_db
```

---

## üöÄ API Base URL
```
http://localhost:8000
```

## üìñ Interactive Documentation
- **Swagger UI:** http://localhost:8000/docs
- **ReDoc:** http://localhost:8000/redoc

---

## üîê Test Credentials

### Admin User
```
Contact Number: 09171234567
Email: admin@blooddonor.ph
```

### Sample Donor Users
```
Contact Numbers: 0915XXXXXXX (generated by seed script)
Check database for full list
```

---

## üì° API Endpoints

### Authentication
```http
POST   /api/v1/auth/login              # Login with contact number
POST   /api/v1/auth/refresh            # Refresh access token
POST   /api/v1/auth/logout             # Logout
```

### User Profile
```http
GET    /api/v1/users/me                # Get current user profile
PUT    /api/v1/users/me                # Update profile
PUT    /api/v1/users/me/preferences    # Update theme preference
```

### Donor Registration (Public)
```http
POST   /api/v1/donor-registrations     # Submit registration (no auth)
GET    /api/v1/donor-registrations     # List registrations (admin only)
PATCH  /api/v1/donor-registrations/{id} # Approve/reject (admin only)
```

### Donor Management
```http
GET    /api/v1/donors                  # List donors with filters
GET    /api/v1/donors/{id}             # Get donor details
PATCH  /api/v1/donors/{id}             # Update donor (admin)
PATCH  /api/v1/donors/{id}/availability # Update availability (admin)
DELETE /api/v1/donors/{id}             # Soft delete donor (admin)
```

### Messages
```http
POST   /api/v1/messages                # Send message to admin (donor)
GET    /api/v1/messages                # List messages (admin)
PATCH  /api/v1/messages/{id}/close     # Close message (admin)
```

### Alerts & Notifications
```http
POST   /api/v1/alerts                  # Create alert (admin)
GET    /api/v1/alerts                  # List alerts (admin)
POST   /api/v1/alerts/{id}/send        # Send scheduled alert (admin)
GET    /api/v1/notifications           # List user notifications
GET    /api/v1/notifications/unread-count # Get unread count
PATCH  /api/v1/notifications/{id}/read # Mark as read
PATCH  /api/v1/notifications/read-all  # Mark all as read
DELETE /api/v1/notifications/{id}      # Delete notification
```

### Donations & Requests
```http
GET    /api/v1/donations/donations     # List donations (admin)
POST   /api/v1/donations/donations     # Record donation (admin)
GET    /api/v1/donations/requests      # List blood requests
POST   /api/v1/donations/requests      # Create blood request (admin)
```

### Reports
```http
GET    /api/v1/reports/summary         # Summary statistics (admin)
GET    /api/v1/reports/blood-type-distribution # Blood type distribution (admin)
GET    /api/v1/reports/monthly-donations # Monthly donation stats (admin)
GET    /api/v1/reports/availability-trend # Availability trend (admin)
```

---

## üß™ Quick Test Commands

### Login as Admin
```bash
curl -X POST http://localhost:8000/api/v1/auth/login \
  -H "Content-Type: application/json" \
  -d '{"contact_number": "09171234567"}'
```

### Get Current User (with token)
```bash
curl -X GET http://localhost:8000/api/v1/users/me \
  -H "Authorization: Bearer YOUR_ACCESS_TOKEN"
```

### List Donors (admin)
```bash
curl -X GET http://localhost:8000/api/v1/donors \
  -H "Authorization: Bearer YOUR_ACCESS_TOKEN"
```

### Submit Registration (public)
```bash
curl -X POST http://localhost:8000/api/v1/donor-registrations \
  -H "Content-Type: application/json" \
  -d '{
    "full_name": "Test Donor",
    "contact_number": "09123456789",
    "age": 25,
    "blood_type": "O+",
    "municipality": "Quezon City",
    "availability": "available"
  }'
```

---

## üîó Quick Links

| Resource | URL |
|----------|-----|
| API Docs | http://localhost:8000/docs |
| ReDoc | http://localhost:8000/redoc |
| Database (Adminer) | http://localhost:8082 |
| PostgreSQL | localhost:5432 |

---

## üìä Database Tables

View data directly:
```sql
-- All users
SELECT * FROM users;

-- Donor registrations
SELECT * FROM donor_registrations;

-- Approved donors
SELECT * FROM donor_profiles;

-- Messages
SELECT * FROM messages;

-- Alerts
SELECT * FROM alerts;

-- Notifications
SELECT * FROM notifications;

-- Donations
SELECT * FROM donations;

-- Blood requests
SELECT * FROM blood_requests;
```

---

## üõ†Ô∏è Start API Server

```bash
# Development mode
uvicorn app.main:app --reload

# Production mode
gunicorn app.main:app -w 4 -k uvicorn.workers.UvicornWorker
```

---

## üìù Notes

- Replace `user` and `password` with your actual database credentials from `.env`
- All authenticated endpoints require `Authorization: Bearer <token>` header
- Get token from `/api/v1/auth/login` endpoint
- Admin endpoints require admin role
- Interactive docs at `/docs` provide "Try it out" functionality
